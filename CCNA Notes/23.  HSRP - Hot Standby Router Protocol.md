# Network Redundancy

The point of redundancy is to eliminate single points of failure. We can still reach the internet if any core/distribution layer switch, router, or links fail.

We will be using this diagram as an example for our configurations

<img width="472" height="446" alt="image" src="https://github.com/user-attachments/assets/3f72f610-ffa4-421c-a637-577be7b80f56" />

Configure the first static route, this will be for R1
- (config)#_ip route 0.0.0.0 0.0.0.0 203.0.113.1_

Configure the backup default static route with a higher admin distance, this one will go to R2
- (config)#_ip route 0.0.0.0 0.0.0.0 10.10.20.2 5_

Then configure a backup link for g0/1, just in case the route to the end users go down.
- (config)#_ip route 10.10.10.0 255.255.255.0 10.10.20.2_

# First Hop Redundancy Protocols - FHRP

First Hop Redundancy Protocols use a Virtual IP and MAC address to allow for automated gateway failover. The hosts use the VIP as their default gateway address. If a physical gateway fails, another gateway will take over.
With our diagram above we will be adding the Virtual IP to R1 and R2. The VIP will be 10.10.10.1. 

The default gateway for the PCs will be pointed at the VIP, then if R1 were to fail, R2 will detect that R1 is down and will automatically use the VIP of R1. So now R2 will become the default gateway but the VIP will be the same.

- Hot Standby Router Protocol: Cisco proprietary, Deployed in active/standby pairs
- Virtual Router Redundancy Protocol: Open standard, deployed in active/standby pair.
- Gateway Load Balancing Protocol: Cisco proprietary, supports active/active load balancing across multiple routers

# Hot Standby Router Protocol - HSRP

HSRP uses a VIP and MAC address to allow for automated gateway failover. The hosts use the VIP as their default gateway address and if the active gatewat fails, the standby gateway will take over.

## HSRP Operations

Both routers have a normal physical IP address and MAC address on their HSRP interface. Unique addresses are used on both routers. They both also have teh HSRP VIP and MAC address configured on the interface, the same addresses are used on both routers.

When they come online, one is elected the HSRP **active** router, the other is in **standby**. The active router owns the VIP and MAC and responds to ARP requests. All traffic for the VIP goes through the active router.

HSRP uses hello packets to message the other router to let them know that it is still active. If the standby router does not receive a hello packet then it will transition to become the active router.

## HSRP Configuration

To enable HSRP you will be using the _standby_ command. The higher the IP address will indicate which Router will become the active router and the other will be the standby.

R1 configuration
- (config)#_interface g0/1_
- (config-if)#_IP address 10.10.10.2 255.255.255.0_
- (config-if)#_no shutdown_
- (config-if)#_standby 1 ip 10.10.10.1_

R2 configuration
- (config)#_interface g0/1_
- (config-if)#_ip address 10.10.10.3 255.255.255.0_
- (config-if)#_no shutdown_
- (config-if)#_standby 1 ip 10.10.10.1_

Verification
- R1#_show standby_

# HSRP Advanced Topics

## Priority and Pre-emption

- Priority on the router can be chosen, the router with the higher priority wil be set as the active. In the event of a tie of the priority, the highest IP address will be chosen.
- Pre-emption is when a higher priority router comes back online after a failure, it will transition back to active. If this setting is not enabled, which is by default, the lower priority router will remain active when the failed router comes back online. You may want to choose this option if the higher priority router is unstable.

### Configuration for priority and pre-emption

R1
- (config)#_interface g0/1_
- (config-if)#_ip address 10.10.10.2 255.255.255.0_
- (config-if)#_no shutdown_
- (config-if)#_standby 1 ip 10.10.10.1_
- (config-if)#_standby 1 priority 110_
- (config-if)#_standby 1 preempt_

R2
- (config)#_interface g0/1_
- (config-if)#_ip address 10.10.10.3 255.255.255.0_
- (config-if)#_no shutdown_
- (config-if)#_standby 1 ip 10.10.10.1_
- (config-if)#_standby 1 priority 90_

### Load Balancing from the same IP subnet

We will need to configure two separate VIPs on each router. Then we will have 50% of the PCs use one VIP and the other half use the other VIP.

In the example down below, we set R1 to have the priority for the 10.10.10.1 default gateway and R2 with 10.10.10.254 default gateway. We still configure both of them with different VIPs but in different standby groups.

<img width="1065" height="334" alt="image" src="https://github.com/user-attachments/assets/a906f7d2-52d7-4efe-adb3-8146ab0894ec" />

### Load Balancing with different subnets

Now in this example we will be setting up different VIP subnets on different interfaces. The G0/1 interface will have the 10.10.10.0/24 subnet and G0/2 will have 10.10.20.0/24 subnet.

We will set R1 to have the priority for 10.10.10.0/24 and R2 will have priority for 10.10.20.0/24.

<img width="1050" height="346" alt="image" src="https://github.com/user-attachments/assets/1731c915-e412-4534-a9ce-4055807e5526" />
